(window.webpackJsonp=window.webpackJsonp||[]).push([[2,3],{350:function(t,e,r){"use strict";r.r(e);var o=r(33),n=(r(89),{name:"AddAuthor",data:function(){return{form:{author_name:"",number_of_books:0},show:!1}},methods:{onSubmit:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var data,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.preventDefault(),""!==e.form.author_name){r.next=4;break}return e.show=!0,r.abrupt("return");case 4:if(data={author_name:e.form.author_name,number_of_books:e.form.number_of_books},r.prev=5,null===(o=localStorage.getItem("access_token"))){r.next=14;break}return r.next=10,e.$axios.post("/add-author",data,{headers:{Authorization:"Bearer ".concat(o),Accept:"multipart/form-data","Content-Type":"application/json"}});case 10:(r.sent.status=200)&&(e.$toast.success("Author added",{duration:5e3}),e.form.author_name="",e.form.number_of_books=0),r.next=16;break;case 14:e.$toast.error("Not Authorized",{duration:5e3}),e.$router.push({path:"/"});case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(5),e.$toast.error("Check all fields",{duration:5e3}),console.error(r.t0);case 22:case"end":return r.stop()}}),r,null,[[5,18]])})))()}}}),c=r(59),component=Object(c.a)(n,(function(){var t=this,e=t._self._c;return e("div",[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-3",modifiers:{"modal-3":!0}}],ref:"Btn",staticClass:"bg-primary ml-2 w-100"},[t._v("Add Author")]),t._v(" "),e("b-modal",{attrs:{id:"modal-3",title:"Add Author"},on:{ok:t.onSubmit}},[e("b-form",{on:{submit:t.onSubmit}},[e("b-form-group",{attrs:{id:"input-group-1",label:"Author Name:","label-for":"input-1"}},[e("b-form-input",{attrs:{id:"input-1",placeholder:"Enter author name",required:""},model:{value:t.form.author_name,callback:function(e){t.$set(t.form,"author_name",e)},expression:"form.author_name"}})],1)],1),t._v(" "),t.show?e("div",[e("p",{staticClass:"text-danger"},[t._v("Author name is required*")])]):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports},352:function(t,e,r){"use strict";r.r(e);r(2),r(1);var o=r(33),n=(r(89),r(15),{components:{AddAuthor:r(350).default},data:function(){return{perPage:6,currentPage:1,rows:1,fields:["id","author_name","number_of_books","actions"],authors:[],form:{author_id:"",author_name:"",number_of_books:0},filter:null,output:null}},mounted:function(){this.getAuthors()},methods:{onFiltered:function(t){this.rows=t.length,this.currentPage=1},getAuthors:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(r=localStorage.getItem("access_token"))){e.next=10;break}return e.next=5,t.$axios.get("/authors",{headers:{Authorization:"Bearer ".concat(r)}});case 5:(n=e.sent).data.map(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(o){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/author-books/".concat(o.id),{headers:{Authorization:"Bearer ".concat(r)}});case 2:return n=e.sent,o.number_of_books=n.data.length,t.authors.unshift(o),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.rows=n.data.length,e.next=12;break;case 10:t.$toast.error("Not Authorized",{duration:5e3}),t.$router.push({path:"/"});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))()},updateModal:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e.form.author_id=t.id,e.form.author_name=t.author_name;case 2:case"end":return r.stop()}}),r)})))()},updateAuthor:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var data,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.form.author_name){e.next=3;break}return t.$toast.error("Add author name",{duration:5e3}),e.abrupt("return");case 3:if(data={id:t.form.author_id,author_name:t.form.author_name},e.prev=4,null===(r=localStorage.getItem("access_token"))){e.next=13;break}return e.next=9,t.$axios.put("/update-author",data,{headers:{Authorization:"Bearer ".concat(r),Accept:"multipart/form-data","Content-Type":"application/json"}});case 9:(e.sent.status=200)?(t.$toast.success("Author updated",{duration:5e3}),t.form.author_id="",t.form.author_name=""):(t.$toast.error("Not Authorized",{duration:5e3}),t.$router.push({path:"/"})),e.next=15;break;case 13:t.$toast.error("Not Authorized",{duration:5e3}),t.$router.push({path:"/"});case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),t.$toast.success("Check all fields",{duration:5e3}),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[4,17]])})))()},deteleAuthor:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var data,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!0!==confirm("Are you sure to delete author?")){r.next=25;break}if(data={id:t.id},r.prev=2,null===(o=localStorage.getItem("access_token"))){r.next=17;break}return r.next=7,e.$axios.delete("/delete-author",{headers:{Authorization:"Bearer ".concat(o),Accept:"multipart/form-data","Content-Type":"application/json"},data:data});case 7:if(!(r.sent.status=200)){r.next=13;break}return e.$toast.success("Author deleted",{duration:5e3}),r.abrupt("return",!0);case 13:e.$toast.error("Not Authorized",{duration:5e3}),e.$router.push({path:"/"});case 15:r.next=19;break;case 17:e.$toast.error("Not Authorized",{duration:5e3}),e.$router.push({path:"/"});case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(2),e.$toast.error("An error occured",{duration:5e3}),console.error(r.t0);case 25:case"end":return r.stop()}}),r,null,[[2,21]])})))()}}}),c=n,l=r(59),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"container border rounded mt-4 p-4 overflow-auto"},[t._m(0),t._v(" "),e("div",{staticClass:"d-flex justify-content-center mb-3"},[e("b-form-input",{attrs:{type:"search",placeholder:"Type to filter data"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),e("div",{staticClass:"w-25"},[e("AddAuthor")],1)],1),t._v(" "),e("b-table",{staticClass:"mt-4",attrs:{id:"my-table",striped:"",filter:t.filter,fields:t.fields,items:t.authors,"per-page":t.perPage,"current-page":t.currentPage,medium:""},on:{filtered:t.onFiltered},scopedSlots:t._u([{key:"cell(actions)",fn:function(r){var o=r.item;return[e("span",[e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-4",modifiers:{"modal-4":!0}}],staticClass:"bg-success",on:{click:function(e){return t.updateModal(o)}}},[t._v("Edit")])],1),t._v(" "),e("span",[e("b-btn",{staticClass:"bg-danger",on:{click:function(e){return t.deteleAuthor(o)}}},[t._v("Delete")])],1)]}}])}),t._v(" "),e("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}),t._v(" "),e("div",[e("b-modal",{attrs:{id:"modal-4",title:"Edit Author"},on:{ok:t.updateAuthor}},[e("b-form",{on:{submit:t.updateAuthor}},[e("b-form-group",{attrs:{id:"input-group-1",label:"Author Name:","label-for":"input-1"}},[e("b-form-input",{attrs:{id:"input-1",placeholder:"Enter author name",required:""},model:{value:t.form.author_name,callback:function(e){t.$set(t.form,"author_name",e)},expression:"form.author_name"}})],1)],1)],1)],1)],1)}),[function(){var t=this._self._c;return t("div",[t("h4",[this._v("Authors Table")])])}],!1,null,null,null);e.default=component.exports}}]);